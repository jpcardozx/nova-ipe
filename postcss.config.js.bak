
// postcss.config.js
// Vers√£o otimizada para compatibilidade com Vercel e NextJS 15+
const path = require('path');

// Use our custom nesting fallback plugin to fix the class inheritance error
const customNestingPath = path.join(process.cwd(), 'lib', 'plugins', 'nesting-fallback.js');
let nestingPlugin;
try {
  nestingPlugin = require(customNestingPath);
} catch (error) {
  nestingPlugin = function () {
    return {
      postcssPlugin: 'tailwindcss-nesting-fallback',
      Once(root) { return root; }
    };
  };
  nestingPlugin.postcss = true;
}

module.exports = {
  plugins: {
    // Use our custom nesting implementation first
    'tailwindcss/nesting': nestingPlugin,
    'tailwindcss': {},
    'autoprefixer': {},
    ...(process.env.NODE_ENV === 'production' ? { 'cssnano': {} } : {})
  }
};
